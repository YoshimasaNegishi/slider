<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>全幅スライダー（上半分表示）</title>

<style>
    body {
        margin: 0;
        background: #111;
        font-family: sans-serif;
    }

    /* ★ ブラウザ幅いっぱい表示 */
    .comparison-container {
        width: 100vw;
        max-width: 100vw;
        margin: 0 calc(50% - 50vw);
        overflow: hidden;
        position: relative;
    }

    /* ★ 表示高さ決め（調整ポイント） */
    .image-wrapper {
        position: relative;
        width: 100%;
        height: 0;
        padding-bottom: 40%; 
    }

    .image-before,
    .image-after {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;

        /* 上半分優先表示 */
        object-fit: cover;
        object-position: top center;

        /* 選択禁止 */
        user-select: none;
        -webkit-user-drag: none;
        pointer-events: none;

        /* ジャギー軽減 */
        image-rendering: -webkit-optimize-contrast;
        transform: translateZ(0);
        backface-visibility: hidden;
    }

    .image-after {
        clip-path: inset(0 0 0 50%);
    }

    .slider {
        position: absolute;
        top: 0;
        left: 50%;
        width: 4px;
        height: 100%;
        background: #fff;
        cursor: ew-resize;
        transform: translateX(-50%);
        z-index: 10;
    }

    .slider::before {
        content:"";
        position:absolute;
        top:50%;
        left:50%;
        transform:translate(-50%,-50%);
        width:44px;
        height:44px;
        border-radius:50%;
        background:#fff;
        box-shadow:0 4px 12px rgba(0,0,0,0.4);
    }
</style>
</head>
<body>

<div class="comparison-container" id="comparison">
    <div class="image-wrapper">
        <img class="image-before" id="img-before" src="before.jpg" alt="Before" />
        <img class="image-after" id="img-after" src="after.jpg" alt="After" />
        <div class="slider" id="slider"></div>
    </div>
</div>

<script>
    let isDragging = false;
    const comparison = document.getElementById("comparison");
    const slider = document.getElementById("slider");
    const imgAfter = document.getElementById("img-after");

    function updateSlider(x) {
        const rect = comparison.getBoundingClientRect();
        const offsetX = x - rect.left;
        let percentage = (offsetX / rect.width) * 100;
        percentage = Math.max(0, Math.min(100, percentage));

        slider.style.left = percentage + "%";
        imgAfter.style.clipPath = `inset(0 0 0 ${percentage}%)`;
    }

    slider.addEventListener("mousedown", () => isDragging = true);
    document.addEventListener("mouseup", () => isDragging = false);
    document.addEventListener("mousemove", e => isDragging && updateSlider(e.clientX));

    slider.addEventListener("touchstart", e => { isDragging = true; e.preventDefault(); });
    document.addEventListener("touchend", () => isDragging = false);
    document.addEventListener("touchmove", e => isDragging && updateSlider(e.touches[0].clientX));
</script>

</body>
</html>
